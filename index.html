<div class="form-group">
    <input type="text" id="inputTarefa" placeholder="O que precisa ser feito?">
    <input type="tel" id="inputWhats" placeholder="WhatsApp (ex: 5511999999999)">
    <div style="display: flex; gap: 5px;">
        <select id="selectCategoria" style="flex: 1;">
            <option value="Geral">üìÇ Geral</option>
            <option value="Mercado">üõí Mercado</option>
            <option value="Faxina">üßπ Faxina</option>
            <option value="Pet">üêæ Pet</option>
        </select>
        <input type="date" id="inputData" style="flex: 1;">
    </div>
    <button id="btnSalvar">Salvar e Notificar Agora</button>
</div>

<script type="module">
    // ... (mantenha o resto do c√≥digo anterior)

    document.getElementById('btnSalvar').onclick = async () => {
        const desc = document.getElementById('inputTarefa');
        const whats = document.getElementById('inputWhats').value;
        const cat = document.getElementById('selectCategoria').value;
        const data = document.getElementById('inputData').value;
        
        if (desc.value) {
            // 1. SALVA NO BANCO
            await addDoc(collection(db, "tarefas"), {
                descricao: desc.value,
                categoria: cat,
                dataLimite: data,
                whatsappDestino: whats,
                autorNome: auth.currentUser.displayName,
                autorFoto: auth.currentUser.photoURL,
                concluida: false,
                criadoEm: new Date()
            });

            // 2. DISPARA O WHATSAPP AUTOMATICAMENTE (Se houver n√∫mero)
            if(whats) {
                const dataFmt = data.split('-').reverse().join('/');
                const msg = encodeURIComponent(`üìå *Nova Tarefa Familiar*\n\nTarefa: ${desc.value}\nCategoria: ${cat}\nData: ${dataFmt}\n\nCriado por: ${auth.currentUser.displayName}`);
                window.open(`https://wa.me/${whats}?text=${msg}`, '_blank');
            }

            desc.value = "";
            alert("Tarefa salva e notifica√ß√£o enviada!");
        }
    };
    // ...
</script>

