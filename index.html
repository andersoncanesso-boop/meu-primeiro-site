<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gest√£o Familiar - RESET</title>
    <style>
        body { font-family: sans-serif; background: #f0f2f5; display: flex; justify-content: center; padding: 20px; }
        .container { width: 100%; max-width: 450px; text-align: center; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        button { width: 100%; padding: 15px; margin-top: 10px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; }
        .btn-login { background: #2563eb; color: white; }
        .item { background: #fff; border: 1px solid #ddd; padding: 10px; margin-top: 10px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; text-align: left; }
        .btn-del { background: #ef4444; color: white; width: auto; padding: 5px 10px; margin: 0; }
    </style>
</head>
<body>

<div class="container">
    <div id="loginArea">
        <h1>üè† Acesso Familiar</h1>
        <button id="btnLogin" class="btn-login">ENTRAR AGORA</button>
    </div>

    <div id="appArea" style="display:none;">
        <h3>Itens no Banco de Dados</h3>
        <div id="lista"></div>
        <p style="margin-top:20px; font-size: 0.8rem; color: gray;">Ap√≥s apagar os itens, me avise para voltarmos com o design completo.</p>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, onSnapshot, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const config = { 
        apiKey: "AIzaSyBG9XmFduYzpXhYcWF9UPSbGa-w2GZ3cKc", 
        authDomain: "gestao-familiar-ac7d6.firebaseapp.com", 
        projectId: "gestao-familiar-ac7d6", 
        storageBucket: "gestao-familiar-ac7d6.firebasestorage.app", 
        messagingSenderId: "1063581141078", 
        appId: "1:1063581141078:web:af2fc67412dbc6fee313f7" 
    };

    const app = initializeApp(config);
    const db = getFirestore(app);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    onAuthStateChanged(auth, user => {
        if (user) {
            document.getElementById('loginArea').style.display = 'none';
            document.getElementById('appArea').style.display = 'block';
            
            onSnapshot(collection(db, "tarefas"), snap => {
                const listaDiv = document.getElementById('lista');
                listaDiv.innerHTML = "";
                snap.forEach(d => {
                    const t = d.data();
                    const div = document.createElement('div');
                    div.className = 'item';
                    div.innerHTML = `
                        <div><strong>${t.descricao}</strong><br><small>${t.categoria}</small></div>
                        <button class="btn-del" onclick="window.matar('${d.id}')">APAGAR üóëÔ∏è</button>
                    `;
                    listaDiv.appendChild(div);
                });
            });
        }
    });

    window.matar = async (id) => {
        if(confirm("Eliminar este item para sempre?")) {
            await deleteDoc(doc(db, "tarefas", id));
        }
    };

    document.getElementById('btnLogin').onclick = () => signInWithPopup(auth, provider);
</script>
</body>
</html>
